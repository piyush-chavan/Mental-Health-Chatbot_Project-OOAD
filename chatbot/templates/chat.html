<!DOCTYPE html>
<html>

<head>
    <title>Chatbot</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
        html,
        body {
            height: 100%;
            overflow: hidden;
            margin: 0;
        }

        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            display: flex;
            height: 4%;
            justify-content: space-between;
            background: #128C7E;
            color: #fff;
            padding: 10px 20px;
        }

        .container {
            padding-top: 3%;
            display: flex;
            height: 100vh;
        }

        .sidebar {
            width: 250px;
            background: #128C7E;
            color: #fff;
            padding: 20px;
        }

        .profile {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            padding: 0px;
        }

        .profile-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #fff;
            color: #128C7E;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin-left: 15px;
            text-decoration: none;
        }

        .profile-circle:hover {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #15eb20;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin-left: 15px;
            text-decoration: none;
        }

        .logout-link {
            color: #fff;
            text-decoration: none;
            background-color: #2bc7b5;
            padding: 10px;
            margin-bottom: 10px;
            margin-left: 0px;
        }

        .auth-links {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            margin-top: 10px;
            margin-left: auto;

        }

        .login-link,
        .register-link {
            color: #fff;
            text-decoration: none;
            background-color: #15c0ac;
            padding: 10px;
            margin-left: 10px;
            margin-bottom: 10px;
            cursor: pointer;
        }

        .welcome {

            color: #fff;
            padding-top: 20px;
            margin-left: 0px;
            font-size: 18px;
            margin-top: 20px;
        }

        .chat-window {
            flex: 1;
            background: #fff;
            display: flex;
            flex-direction: column;
            overflow: auto;
        }

        .chatHistory {

            margin-top: 20px;
            list-style: none;
            height: calc(100% - 150px);
            overflow-y: auto;
        }

        .chatHistory::-webkit-scrollbar {
            width: 12px;
            margin-left: 5px;
        }

        .chatHistory::-webkit-scrollbar-thumb {
            background: #15c0ac;
            border-radius: 6px;
        }

        .chatHistory::-webkit-scrollbar-track {
            background: #128C7E;
            border-radius: 6px;
        }

        .chatHistory::-webkit-scrollbar-thumb:hover {
            background: #15c0ac;
        }

        li.chat-date {
            color: #fff;
            margin-top: 20px;
            font-size: 20px;
            border-bottom: 1px solid #fff;
            cursor: pointer;
        }

        li.chat-date:hover {
            background-color: rgb(21, 203, 21);

        }


        .messages {
            flex: 1;
            padding: 20px;
            overflow-y: scroll;
            display: flex;
            flex-direction: column;
            margin-bottom: 100px;
            margin-top: 50px;
        }

        .message {
            margin: 10px 0;
            padding: 10px;
            border-radius: 10px;
        }

        .user-message {
            align-self: flex-end;
            background: #DCF8C6;
            padding: 10px;
            border-radius: 10px;
        }

        .bot-message {
            align-self: flex-start;
            background: #EDEDED;
            margin-right: auto;
        }

        .input-bar {
            position: fixed;
            bottom: 0;
            left: 270px;
            right: 0px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
        }

        .input-form {
            display: flex;
            flex: 1;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .input-box {
            flex: 1;
            width: 100%;
            background: #DCF8C6;
            padding: 10px;
            border-radius: 10px;
        }

        .input-button {
            background: #128C7E;
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }

        .box {
            margin: auto;
            padding: 0;
            padding-left: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-image: url("https://img.freepik.com/free-vector/global-data-security-personal-data-security-cyber-data-security-online-concept-illustration-internet-security-information-privacy-protection_1150-37336.jpg?size=626&ext=jpg&uid=R123926771&semt=sph");
        }

        .options-container {
            margin-top: 30px;
            margin-bottom: 30px;

        }

        .option {
            margin: 10px;
        }

        .next-button {
            align-self: flex-end;
            background: #DCF8C6;
            margin-right: 50px;
            margin-bottom: 20px;
            padding: 10px;
            padding-left: 20px;
            padding-right: 20px;
            border-radius: 10px;
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playpen+Sans&display=swap" rel="stylesheet">
</head>

<body>

    <div class="navbar">
        {% if request.user.is_authenticated %}
        <!-- <a class="profile-circle" href="/">{{request.user.username.0}}</a> -->
        <a class="profile-circle" href="/"><img src="/static/img/brain_transparent.png" alt="img-logo" width="50px">
        </a>


        {% else %}
        <!-- <a class="profile-circle" href="/">G</a> -->
        <a class="profile-circle" href="/"><img src="/static/img/brain_transparent.png" alt="img-logo" width="50px">
        </a><br>
        <h2 style="font-family: 'Playpen Sans', cursive; ">Guest User</h2>
        {% endif %}

        <div class="logout-login">

        </div>

        {% if request.user.is_authenticated %}

        <div class="logout-login">
            <a class="login-link" style="font-family: 'Playpen Sans', cursive;" id="test_button">Take a Test</a>
            <a class="logout-link" style="font-family: 'Playpen Sans', cursive;" href="{% url 'logout' %}">Logout</a>

            {% else %}
            <div class="auth-links">
                <a class="login-link" style="font-family: 'Playpen Sans', cursive;" id="test_button">Take a Test</a>
                <a class="login-link" style="font-family: 'Playpen Sans', cursive;" href="{% url 'login' %}">Signin</a>
                <a class="register-link" style="font-family: 'Playpen Sans', cursive;"
                    href="{% url 'register' %}">Register</a>
            </div>
            {% endif %}
        </div>
    </div>

    <div class="container">
        <div class="sidebar">
            {% if request.user.is_authenticated %}
            <div class="welcome" style="font-family: 'Playpen Sans', cursive;">Welcome {{request.user.username}}</div>
            <ul id="chatHistoryList" class="chatHistory">
                <!--           ____________________dates___________________                    -->
            </ul>
            {% endif %}
        </div>

        <div class="chat-window">
            <div class="messages" id="chatbox" style="font-family: 'Playpen Sans', cursive;">

                <!-- _______________________chat messages_______________________________ -->
            </div>
            <div class="input-bar">
                <form method="post" id="userInputForm" class="input-form">
                    {% csrf_token %}
                    {{ form.message }}
                    <input type="submit" class="input-button btn" id="post_button" value="Send">
                </form>
            </div>

        </div>
    </div>

    <script>
        const addDivForm = document.getElementById("userInputForm");
        const container = document.getElementById("chatbox");
        const testButton = document.getElementById("test_button");
        const chatEnabled = true;
        var radioButtonIndex = 0;
        var testButtonEnabled = true;

        let surveyCompleted = false;
        let currentSurveyProgress = 0;

        function renderChatMessages(messages) {
            const chatbox = document.getElementById('chatbox');
            chatbox.innerHTML = '';

            for (const message of messages) {
                const user_message = message.user;
                const bot_message = message.bot;

                var regex = /\$(\d+)\$/; // Regular expression to match the number between $
                var match = regex.exec(user_message);

                if (match) {
                    var extractedNumber = match[1]; // Extracted number
                    if (bot_message) {
                        loadSavedSurvey(extractedNumber, bot_message);
                    }
                } else {
                    const usermessageDiv = document.createElement('div');
                    const botmessageDiv = document.createElement('div');
                    usermessageDiv.className = 'message user-message';
                    botmessageDiv.className = 'message bot-message';
                    usermessageDiv.textContent = user_message;
                    botmessageDiv.textContent = bot_message;



                    chatbox.appendChild(usermessageDiv);
                    chatbox.appendChild(botmessageDiv);
                }


            }
        }

        function renderSurvey(questions, selectedSurvey, labels) {
            const chatbox = document.getElementById('chatbox');
            const heading = document.createElement('div');
            heading.className = "message bot-message";
            heading.textContent = "Over the last two weeks, how often have you been bothered by any of the following problems?";
            chatbox.appendChild(heading);
            const result = document.createElement('div');
            result.className = "message bot-message";
            let i = 0;
            var elem;
            const responseList = [];
            var score = 0;

            function renderNextQuestion() {
                if (i < questions.length) {
                    if (elem) {
                        elem.remove();
                    }
                    const question = questions[i];
                    const questionDiv = document.createElement('div');
                    const optionContainer = document.createElement('div');
                    optionContainer.className = 'options-container';
                    questionDiv.className = 'message bot-message';
                    questionDiv.textContent = question;

                    chatbox.appendChild(questionDiv);


                    const radioButtons = [];

                    for (let j = 0; j < labels.length; j++) {
                        const button = document.createElement('input');
                        button.type = 'radio';
                        button.name = 'survey_options' + String(radioButtonIndex);
                        button.value = j;
                        radioButtons.push(button);
                    }

                    radioButtonIndex++;



                    for (let j = 0; j < labels.length; j++) {
                        const label = document.createElement('label');
                        label.textContent = labels[j];
                        const option = document.createElement('div');
                        option.className = 'option';
                        option.appendChild(radioButtons[j]);
                        option.appendChild(label);
                        optionContainer.appendChild(option);
                    }

                    chatbox.appendChild(optionContainer);

                    const nextButton = document.createElement('button');
                    nextButton.textContent = 'Next';
                    nextButton.className = 'next-button';
                    nextButton.id = "next_button";

                    let selectedValue = null;

                    radioButtons.forEach(function (radioButton) {
                        radioButton.addEventListener('change', function () {
                            if (this.checked) {
                                selectedValue = parseInt(this.value); // Parse the value as an integer
                                if (selectedSurvey == 2) {
                                    if (i == 3 || i == 4 || i == 6 || i == 7) {
                                        selectedValue = 4 - selectedValue;
                                    }
                                }
                                console.log(selectedValue);
                            }
                        });
                    });
                    chatbox.appendChild(nextButton);
                    nextButton.addEventListener('click', function () {
                        if (selectedValue !== null) {
                            
                            score += selectedValue;
                            console.log('Score:', score);
                            responseList.push(selectedValue);

                            console.log('pushed : ', selectedValue)
                            selectedValue = null; // Reset the selectedValue
                            
                            if (i < questions.length) {
                                i++;
                                renderNextQuestion();
                            }
                            target_button = document.getElementById('next_button');
                            target_button.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    });


                    elem = nextButton;
                } else {
                    // Survey is completed
                    elem.remove();

                    switch (selectedSurvey) {
                        case 0:
                            if (score >= 0 && score <= 4) {
                                result.textContent = "You have no symptoms of depression";
                            } else if (score >= 5 && score <= 9) {
                                result.textContent = "It seems you have mild symptoms of depression";
                            } else if (score >= 10 && score <= 14) {
                                result.textContent = "It seems you have moderate symptoms of depression";
                            } else if (score >= 15 && score <= 19) {
                                result.textContent = "It seems you have moderately severe depression";
                            } else {
                                result.textContent = "Your symptoms seems like of severe depression";
                            }
                            break;
                        case 1:
                            if (score >= 0 && score <= 4) {
                                result.textContent = "You have minimal level of anxiety";
                            }
                            else if (score >= 5 && score <= 9) {
                                result.textContent = "You have mild level of anxiety";
                            }
                            else if (score >= 10 && score <= 14) {
                                result.textContent = "You have moderate level of anxiety";
                            }

                            else {
                                result.textContent = "You are probably suffering from severe anxiety disorder";
                            }
                            break;
                        case 2:
                            if (score >= 0 && score <= 13) {
                                result.textContent = "It doesn't seem like you are suffering from stress";
                            } else if (score >= 14 && score <= 26) {
                                result.textContent = "You seem to be suffering from moderate levels of stress";
                            } else {
                                result.textContent = "You seem to be suffering from high levels of stress";
                            }
                            break;
                        case 3:
                            if (score > 44) {
                                result.textContent = "It seems you may possibly be suffering from PTSD";
                            } else {
                                result.textContent = "It doesn't seem like you are suffering from PTSD";
                            }
                            break;
                        case 4:
                            break;
                        case 5:
                            break;
                        case 6:
                            break;
                        case 7:
                            break;
                    }



                    chatbox.appendChild(result);
                    testButtonEnabled = true;
                    console.log(responseList);
                    var commaSeparatedString = responseList.join(',');
                    console.log(commaSeparatedString);
                    const csrftoken = getCookie("csrftoken");
                    $.ajax({
                        type: "POST",
                        url: "/save_survey/",
                        headers: {
                            "X-CSRFToken": csrftoken
                        },
                        data: {
                            "survey_no": selectedSurvey,
                            "response": commaSeparatedString,
                        },
                        success: function (result) {
                            console.log(result);

                        },
                        dataType: "json"
                    });
                }
            }

            renderNextQuestion();

        }

        function startNewSurvey(surveyData, selectedSurvey, survey_labels) {
            surveyCompleted = false;

            currentSurveyProgress = 0;
            renderSurvey(surveyData, selectedSurvey, survey_labels);
        }

        testButton.addEventListener("click", function () {

            if (testButtonEnabled) {
                testButtonEnabled = false;
                const chat_box = document.getElementById('chatbox');
                const choice = document.createElement('div')
                choice.className = "message bot-message";
                choice.textContent = "Choose the test you want to take";
                chat_box.appendChild(choice);
                const optionContainer = document.createElement('div');
                optionContainer.className = 'options-container';
                const radioButtons = [];
                const labels = [
                    "Depression", "Anxiety", "Stress", "PTSD",
                ]; //"Addiction", "Bipolar Disorder", "Eating Disorder", "Schizophrenia"
                for (let j = 0; j < labels.length; j++) {
                    const button = document.createElement('input');
                    button.type = 'radio';
                    button.name = 'survey_options' + String(radioButtonIndex);
                    button.value = j;
                    radioButtons.push(button);
                }
                radioButtonIndex++;


                for (let j = 0; j < labels.length; j++) {
                    const label = document.createElement('label');
                    label.textContent = labels[j];
                    const option = document.createElement('div');
                    option.className = 'option';
                    option.appendChild(radioButtons[j]);
                    option.appendChild(label);
                    optionContainer.appendChild(option);
                }

                chatbox.appendChild(optionContainer);

                const nextButton = document.createElement('button');
                nextButton.textContent = 'Next';
                nextButton.className = 'next-button';
                nextButton.id = "next_button";

                let selectedValue = null;

                radioButtons.forEach(function (radioButton) {
                    radioButton.addEventListener('change', function () {
                        if (this.checked) {
                            selectedValue = parseInt(this.value); // Parse the value as an integer
                            console.log(selectedValue);
                        }
                    });
                });


                chat_box.appendChild(nextButton);
                nextButton.addEventListener('click', function () {
                    if (selectedValue != null) {
                        nextButton.remove();

                        $.ajax({
                            url: "/load_survey/",
                            method: "GET",
                            success: function (data) {

                                let survey_data = null;
                                let survey_labels = null;

                                switch (selectedValue) {
                                    case 0:
                                        survey_data = data.depression;
                                        survey_labels = data.depression_labels;
                                        break;
                                    case 1:
                                        survey_data = data.anxiety;
                                        survey_labels = data.anxiety_labels;
                                        break;
                                    case 2:
                                        survey_data = data.stress;
                                        survey_labels = data.stress_labels;
                                        break;
                                    case 3:
                                        survey_data = data.ptsd;
                                        survey_labels = data.ptsd_labels;
                                        break;
                                    case 4:
                                        survey_data = data.addiction;
                                        survey_labels = data.addiction_labels;
                                        break;
                                    case 5:
                                        survey_data = data.bipolar;
                                        survey_labels = data.bipolar_labels;
                                        break;
                                    case 6:
                                        survey_data = data.eating;
                                        survey_labels = data.eating_labels;
                                        break;
                                    case 7:
                                        survey_data = data.schizophrenia;
                                        survey_labels = data.schizophrenia_labels;
                                        break;
                                }

                                if (surveyCompleted || currentSurveyProgress == 0) {
                                    startNewSurvey(survey_data, selectedValue, survey_labels);
                                } else {
                                    renderSurvey(survey_data, selectedValue, survey_labels);
                                }


                                const nextButton = document.querySelector('.next-button');
                                if (nextButton) {
                                    nextButton.scrollIntoView({ behavior: 'smooth', block: 'start' });
                                }
                            },
                            error: function (xhr, status, error) {
                                console.error("Error:", error);
                            }
                        });
                    }
                });
            }

        });



        $.ajax({
            url: "/load_chats/",
            method: "GET",
            success: function (data) {
                const chatHistoryList = document.getElementById('chatHistoryList');

                data.dates.forEach((chatItem) => {

                    const listItem = document.createElement('li');
                    listItem.textContent = chatItem.date;
                    listItem.className = 'chat-date';


                    listItem.addEventListener('click', function () {

                        const selectedDate = chatItem.date;

                        $.ajax({
                            url: "/load_chat/",
                            method: "GET",
                            data: { date: selectedDate },
                            success: function (chatData) {
                                console.log(chatData);
                                renderChatMessages(chatData.chat);
                            },
                            error: function (xhr, status, error) {
                                console.error("Error:", error);
                            }
                        });
                    });

                    chatHistoryList.appendChild(listItem);

                });
            },
            error: function (xhr, status, error) {
                console.error("Error:", error);
            }
        });



        addDivForm.addEventListener("submit", function (event) {

            event.preventDefault();
            const userMessage = document.querySelector('input[name="message"]').value;
            const csrftoken = getCookie("csrftoken");
            if (testButtonEnabled) {
                $.ajax({
                    url: "/chat_data/",
                    method: "POST",
                    headers: {
                        "X-CSRFToken": csrftoken
                    },
                    data: { message: userMessage },
                    success: function (data) {
                        const botResponse = document.createElement("div");
                        botResponse.className = "message bot-message";
                        botResponse.textContent = data.response;

                        const userResponse = document.createElement("div");
                        userResponse.className = "message user-message";
                        userResponse.textContent = data.message;

                        container.appendChild(userResponse);
                        container.appendChild(botResponse);

                        // Scroll to the latest message
                        container.scrollTop = container.scrollHeight;
                    },
                    error: function (xhr, status, error) {
                        console.error("Error:", error);
                    }
                });
            }
            document.querySelector('input[name="message"]').value = "";

        });


        function loadSavedSurvey(surveyNo, options) {
            const chat_box = document.getElementById('chatbox');
            const choice = document.createElement('div')
            choice.className = "message bot-message";
            choice.textContent = "Choose the test you want to take";
            chat_box.appendChild(choice);
            const optionContainer = document.createElement('div');
            optionContainer.className = 'options-container';
            const radioButtons = [];
            const labels = [
                "Depression", "Anxiety", "Stress", "PTSD",
            ]; //"Addiction", "Bipolar Disorder", "Eating Disorder", "Schizophrenia"
            for (let j = 0; j < labels.length; j++) {
                const button = document.createElement('input');
                button.type = 'radio';
                button.name = 'survey_options' + String(radioButtonIndex);
                button.value = j;
                button.disabled = true;
                radioButtons.push(button);
            }
            radioButtonIndex++;


            for (let j = 0; j < labels.length; j++) {
                const label = document.createElement('label');
                label.textContent = labels[j];
                const option = document.createElement('div');
                option.className = 'option';
                option.appendChild(radioButtons[j]);
                option.appendChild(label);
                optionContainer.appendChild(option);
            }
            radioButtons[surveyNo].checked = true;
            chatbox.appendChild(optionContainer);

            $.ajax({
                url: "/load_survey/",
                method: "GET",
                success: function (data) {

                    let survey_data = null;
                    let survey_labels = null;
                    surveyId = parseInt(surveyNo);
                    switch (surveyId) {
                        case 0:

                            survey_data = data.depression;
                            survey_labels = data.depression_labels;
                            break;
                        case 1:
                            survey_data = data.anxiety;
                            survey_labels = data.anxiety_labels;
                            break;
                        case 2:
                            survey_data = data.stress;
                            survey_labels = data.stress_labels;
                            break;
                        case 3:
                            survey_data = data.ptsd;
                            survey_labels = data.ptsd_labels;
                            break;
                        case 4:
                            survey_data = data.addiction;
                            survey_labels = data.addiction_labels;
                            break;
                        case 5:
                            survey_data = data.bipolar;
                            survey_labels = data.bipolar_labels;
                            break;
                        case 6:
                            survey_data = data.eating;
                            survey_labels = data.eating_labels;
                            break;
                        case 7:
                            survey_data = data.schizophrenia;
                            survey_labels = data.schizophrenia_labels;
                            break;
                    }
                    renderSavedSurvey(survey_data, surveyNo, survey_labels, options)
                },
                error: function (xhr, status, error) {
                    console.error("Error:", error);
                }
            });
        }



        function renderSavedSurvey(questions, selectedSurvey, labels, options_data) {
            const chatbox = document.getElementById('chatbox');
            const heading = document.createElement('div');
            heading.className = "message bot-message";
            heading.textContent = "Over the last two weeks, how often have you been bothered by any of the following problems?";
            chatbox.appendChild(heading);
            const result = document.createElement('div');
            result.className = "message bot-message";
            let i = 0;
            var elem;
            const responseList = [];
            var score = 0;
            console.log(options_data);
            const options = options_data.split(",");
            console.log("starting");
            function renderNextQuestion() {
                if (i < questions.length) {

                    console.log("iteration : ");

                    const question = questions[i];
                    const questionDiv = document.createElement('div');
                    const optionContainer = document.createElement('div');
                    optionContainer.className = 'options-container';
                    questionDiv.className = 'message bot-message';
                    questionDiv.textContent = question;

                    chatbox.appendChild(questionDiv);


                    const radioButtons = [];

                    const selectedValue = parseInt(options[i]);
                    score += selectedValue;
                    console.log(selectedValue);

                    if (selectedSurvey == 2) {
                        if (i == 3 || i == 4 || i == 6 || i == 7) {
                            selectedValue = 4 - selectedValue;
                        }
                    }

                    for (let j = 0; j < labels.length; j++) {
                        const button = document.createElement('input');
                        button.type = 'radio';
                        button.name = 'survey_options' + String(radioButtonIndex);
                        button.value = j;
                        button.disabled = true;
                        radioButtons.push(button);
                    }

                    radioButtons[selectedValue].checked = true;
                    radioButtonIndex++;



                    for (let j = 0; j < labels.length; j++) {
                        const label = document.createElement('label');
                        label.textContent = labels[j];
                        const option = document.createElement('div');
                        option.className = 'option';
                        option.appendChild(radioButtons[j]);
                        option.appendChild(label);
                        optionContainer.appendChild(option);
                    }

                    chatbox.appendChild(optionContainer);
                    i++;
                    renderNextQuestion();
                } else {
                    console.log('survey complete');

                    switch (parseInt(selectedSurvey)) {
                        case 0:
                            if (score >= 0 && score <= 4) {
                                result.textContent = "You have no symptoms of depression";
                            } else if (score >= 5 && score <= 9) {
                                result.textContent = "It seems you have mild symptoms of depression";
                            } else if (score >= 10 && score <= 14) {
                                result.textContent = "It seems you have moderate symptoms of depression";
                            } else if (score >= 15 && score <= 19) {
                                result.textContent = "It seems you have moderately severe depression";
                            } else {
                                result.textContent = "Your symptoms seems like of severe depression";
                            }
                            break;
                        case 1:
                            if (score >= 0 && score <= 4) {
                                result.textContent = "You have minimal level of anxiety";
                            }
                            else if (score >= 5 && score <= 9) {
                                result.textContent = "You have mild level of anxiety";
                            }
                            else if (score >= 10 && score <= 14) {
                                result.textContent = "You have moderate level of anxiety";
                            }

                            else {
                                result.textContent = "You are probably suffering from severe anxiety disorder";
                            }
                            break;
                        case 2:
                            if (score >= 0 && score <= 13) {
                                result.textContent = "It doesn't seem like you are suffering from stress";
                            } else if (score >= 14 && score <= 26) {
                                result.textContent = "You seem to be suffering from moderate levels of stress";
                            } else {
                                result.textContent = "You seem to be suffering from high levels of stress";
                            }
                            break;
                        case 3:
                            if (score > 44) {
                                result.textContent = "It seems you may possibly be suffering from PTSD";
                            } else {
                                result.textContent = "It doesn't seem like you are suffering from PTSD";
                            }
                            break;
                        case 4:
                            break;
                        case 5:
                            break;
                        case 6:
                            break;
                        case 7:
                            break;
                    }



                    chatbox.appendChild(result);

                }

            }
            renderNextQuestion();
        }
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== "") {
                const cookies = document.cookie.split(";");
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === name + "=") {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
    </script>

</body>

</html>